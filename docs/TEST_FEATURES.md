# 功能测试指南

## v2.4 新功能测试

### 1. 多图片上传测试

#### 测试步骤：
1. 点击"智能对话"
2. 展开"📎 媒体上传"
3. 点击"选择图片或视频"
4. **选择多个图片**（按住Ctrl或Cmd多选）
5. 观察预览区域

#### 预期效果：
✅ 配置面板显示网格预览（3-4列）
✅ 每个图片右上角有删除按钮
✅ 对话框底部显示"📎 待发送的媒体 (N个)"
✅ 所有图片呈网格排列

#### 发送测试：
1. 输入文字："分析这些图片"
2. 点击发送
3. 观察用户消息

#### 预期效果：
✅ 文本显示在上方
✅ 图片在下方网格排列
✅ 图片可以hover放大
✅ 布局美观整齐

---

### 2. 模型编辑测试

#### 测试步骤：
1. 点击"模型管理"
2. 找到已注册的模型卡片
3. 点击"编辑"按钮
4. 在弹窗中输入系统提示词

#### 示例系统提示词：
```
你是一个专业的运维助手，擅长解决技术问题。
请用简洁专业的语言回答用户的问题。
在思考时使用<think></think>标签包裹你的思考过程。
```

#### 预期效果：
✅ 弹窗显示模型名称（只读）
✅ 可以输入/编辑系统提示词
✅ 点击保存后更新成功
✅ 卡片显示"✓ 已设置"

---

### 3. 系统提示词生效测试

#### 测试步骤：
1. 编辑模型，设置系统提示词
2. 保存并返回对话界面
3. 选择该模型
4. 发送消息："你好"

#### 预期效果：
✅ 模型遵循系统提示词的指示
✅ 回复符合设定的角色
✅ 系统提示词不显示在对话框
✅ 正常流式输出

---

### 4. 多媒体网格布局测试

#### 测试1：多图片
- 上传3张图片
- 发送消息
- 预期：3张图片呈横向排列（或根据宽度换行）

#### 测试2：混合媒体
- 上传2张图片 + 1个视频
- 发送消息
- 预期：图片和视频混合排列，视频可播放

#### 测试3：单个图片
- 上传1张图片
- 发送消息
- 预期：图片独立显示，大小适中

---

### 5. 删除媒体测试

#### 测试步骤：
1. 上传多个图片
2. 点击某个图片右上角的"✕"
3. 观察变化

#### 预期效果：
✅ 该图片从预览区移除
✅ 对话框的待发送预览同步更新
✅ 计数正确（N个）
✅ 可以继续添加新图片

---

### 6. 错误处理测试

#### 测试场景1：API错误
- 使用错误的API Key
- 发送消息

#### 预期效果：
✅ 状态显示"error"（红色）
✅ 错误信息红色显示
✅ 输入框立即恢复
✅ 可以发送新消息

#### 测试场景2：网络错误
- 关闭网络或使用错误URL
- 发送消息

#### 预期效果：
✅ 显示"无法连接到模型服务器"
✅ 状态标签红色
✅ 输入恢复

---

### 7. 暂停功能测试

#### 测试步骤：
1. 发送消息给模型
2. 在生成过程中点击"⏸ 暂停"

#### 预期效果：
✅ 生成立即停止
✅ 状态显示"⏹ 已暂停"
✅ 输入框立即可用
✅ 可以发送新消息
✅ 按钮恢复为"发送"

---

## 视觉检查清单

### 对话框
- [ ] 用户消息右对齐，红色渐变背景
- [ ] Agent消息左对齐，白色背景
- [ ] 头像显示正确（👤 / 🤖）
- [ ] 状态标签灰色小字
- [ ] 多图片网格排列美观

### 媒体预览
- [ ] 配置区：小缩略图网格
- [ ] 对话区：待发送提示清晰
- [ ] 删除按钮可见且可用
- [ ] 悬停效果流畅

### 模型管理
- [ ] 编辑按钮显示
- [ ] 系统提示词状态显示（✓/✗）
- [ ] 卡片悬停左侧红线
- [ ] 动画效果流畅

### 错误状态
- [ ] error标签红色
- [ ] 错误信息红色
- [ ] 状态不消失
- [ ] 可以继续对话

### 生成状态
- [ ] 暂停按钮黄色脉动
- [ ] 输入区域变灰
- [ ] 输入框禁用
- [ ] 恢复及时

---

## 性能检查

### 图片压缩
- [ ] 大图片压缩后 < 1MB
- [ ] 清晰度足够识别
- [ ] 上传速度快
- [ ] 不卡顿

### 多图片
- [ ] 5-10张图片流畅显示
- [ ] 滚动不卡顿
- [ ] 内存占用合理

### 流式输出
- [ ] 实时显示流畅
- [ ] 无明显延迟
- [ ] 可以正常暂停

---

## Bug 检查

### 已修复
- [x] 模型测试失败仍保存
- [x] 生成时可以发送消息
- [x] 单图片限制
- [x] 错误状态不显示

### 需要验证
- [ ] 多图片同时上传
- [ ] 系统提示词生效
- [ ] 编辑模型保存
- [ ] 流式输出稳定性
